# 要件定義書：Jicoo 自動予約 BOT

## 1. システム概要

### 1.1 目的

Jicoo（オンライン予約システム）において、指定されたレッスン時間（20:25）の予約を自動的に行う BOT システムを開発する。

### 1.2 対象ユーザー

- 道川正隆（プロジェクトオーナー兼エンドユーザー）

### 1.3 システムの位置づけ

- 個人利用の自動化ツール
- ローカル PC 上で動作する Java アプリケーション

## 2. 機能要件

### 2.1 監視対象 URL

以下の 4 つの URL を順番に処理する：

1. `https://www.jicoo.com/t/_XDgWVCOgMPP/e/Teacher_Vanessa`
2. `https://www.jicoo.com/t/_XDgWVCOgMPP/e/Jozelly`
3. `https://www.jicoo.com/t/_XDgWVCOgMPP/e/Teacher_Lorna`
4. `https://www.jicoo.com/t/_XDgWVCOgMPP/e/namie`

### 2.2 ログインポップアップ対応

#### 2.2.1 要件

URL へアクセスした際に、ユーザー名とパスワードを求めるポップアップが表示された場合、自動的にログイン処理を行う。

#### 2.2.2 ログイン情報

| 項目       | 値        |
| ---------- | --------- |
| ユーザー名 | students  |
| パスワード | uluru2024 |

#### 2.2.3 処理フロー

1. ページ読み込み後、ログインポップアップの存在を確認
   - 要素: `input[type="text"]`（ユーザー名）
   - 要素: `input[type="password"]`（パスワード）
   - 要素: `button[type="submit"]`（ログインボタン）
2. ポップアップが存在する場合：
   - ユーザー名フィールドに「students」を入力
   - パスワードフィールドに「uluru2024」を入力
   - サブミットボタンをクリック
3. ポップアップが存在しない場合：
   - そのまま次の処理へ進む

### 2.3 カレンダー操作

#### 2.3.1 要件

カレンダー画面で「今日から 1 週間後の日付」を自動的に選択する。

#### 2.3.2 処理フロー

1. 今日の日付を取得
2. 今日から 7 日後の日付を計算
   - 例: 今日が 11/12 → 対象日は 11/19
3. カレンダー上で該当日を探す
4. 該当日をクリック

### 2.4 タイムスロット監視

#### 2.4.1 要件

選択した日付のタイムスロット一覧から「20:25」のボタンを探し、押せる状態になったら即座にクリックする。

#### 2.4.2 処理フロー

1. タイムスロット一覧を取得
2. 「20:25」のボタンを探す
3. ボタンの状態を確認：
   - **ボタンが存在しない** → 次の URL へ
   - **ボタンが disabled** → 次の URL へ
   - **ボタンが押せる状態** → 即座にクリック
4. クリック後、予約フォーム画面へ遷移

#### 2.4.3 監視間隔

- 5〜10 秒ごとにページを更新して監視
- ボタンが押せる状態になった瞬間に即座にクリック

### 2.5 予約フォーム入力

#### 2.5.1 要件

予約フォーム画面で以下の情報を自動入力する。

#### 2.5.2 入力項目

| 項目           | 入力値                 |
| -------------- | ---------------------- |
| 名前           | 道川正隆               |
| メールアドレス | masataaaka3@icloud.com |

### 2.6 予約確定

#### 2.6.1 要件

予約フォームに入力後、予約確定ボタン（submit）を押して予約を完了する。

#### 2.6.2 処理フロー

1. 予約確定ボタン（submit）をクリック
2. 成功画面に移動したことを確認
3. その日の処理をすべて終了

### 2.7 エラーハンドリング

#### 2.7.1 要件

エラーが発生した場合、適切にリトライする。

#### 2.7.2 リトライ条件

- ネットワークエラー
- 要素が見つからない
- タイムアウト
- その他の予期しないエラー

#### 2.7.3 リトライ回数

- 最大 3 回までリトライ
- リトライ間隔: 5 秒

## 3. 非機能要件

### 3.1 パフォーマンス

- ページ読み込み待機時間: 最大 30 秒
- 要素検出待機時間: 最大 10 秒
- 監視間隔: 5〜10 秒

### 3.2 可用性

- 24 時間稼働を想定
- エラー発生時も自動リトライ

### 3.3 ログ出力

- すべての処理ステップをログに記録
- エラー発生時は詳細なエラー情報を記録
- ログレベル: INFO, WARN, ERROR

### 3.4 セキュリティ

- ログイン情報は設定ファイルまたは環境変数で管理
- ログファイルに機密情報を出力しない

## 4. 技術要件

### 4.1 開発言語・フレームワーク

- **Java**: 17 以上
- **Selenium**: 4 以上
- **WebDriverManager**: 最新版（ChromeDriver 自動取得）

### 4.2 実行環境

- **OS**: Windows 10/11
- **Java Runtime**: Java 17 以上
- **ブラウザ**: Chrome（ChromeDriver 自動取得）

### 4.3 動作モード

- ヘッドレスモード対応（オプション）
- 通常モード（デフォルト）

### 4.4 依存ライブラリ

- Selenium Java
- WebDriverManager
- SLF4J（ログ出力）
- Logback（ログ実装）

## 5. 制約事項

### 5.1 技術的制約

- Java 17 以上が必要
- Chrome ブラウザが必要
- インターネット接続が必要

### 5.2 運用制約

- ローカル PC 上で動作
- 24 時間稼働を想定（必要に応じて）

### 5.3 ビジネス制約

- 個人利用のみ
- 商用利用は想定しない

## 6. 成功基準

1. ✅ 4 つの URL すべてで正常に動作する
2. ✅ ログインポップアップを自動処理できる
3. ✅ 1 週間後の日付を自動選択できる
4. ✅ 20:25 のタイムスロットを自動的に予約できる
5. ✅ エラー発生時に適切にリトライする
6. ✅ ログが適切に出力される
7. ✅ ヘッドレスモードで動作する

## 7. 除外事項

以下の機能は本プロジェクトのスコープ外とする：

- 予約のキャンセル機能
- 複数の時間枠への対応（20:25 のみ）
- 予約履歴の管理機能
- 通知機能（メール・Slack 等）
- Web UI（コマンドライン実行のみ）

---

**作成日**: 2025-11-18  
**確定日**: 2025-11-18  
**最終更新日**: 2025-11-18  
**バージョン**: 1.0
